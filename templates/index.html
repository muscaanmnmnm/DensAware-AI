<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BreastCare - Density-Aware AI</title>
    <script src="[https://cdn.tailwindcss.com](https://cdn.tailwindcss.com)"></script>
    <link rel="preconnect" href="[https://fonts.googleapis.com](https://fonts.googleapis.com)">
    <link rel="preconnect" href="[https://fonts.gstatic.com](https://fonts.gstatic.com)" crossorigin>
    <link href="[https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lato:wght@300;400;500;600&display=swap](https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lato:wght@300;400;500;600&display=swap)" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['Playfair Display', 'serif'],
                        'sans': ['Lato', 'sans-serif'],
                    },
                    colors: {
                        rose: { 50: '#fff1f2', 100: '#ffe4e6', 200: '#fecdd3', 500: '#f43f5e', 700: '#be123c', 800: '#9f1239' }
                    }
                }
            }
        }
    </script>
</head>
<body class="font-sans text-gray-700 bg-gradient-to-b from-rose-50 to-pink-50">

    <!-- NAVIGATION -->
    <nav class="bg-white/80 backdrop-blur-sm border-b border-rose-100 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">üéóÔ∏è</span>
                    <span class="text-xl font-semibold text-rose-800 font-serif">BreastCare AI</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#tool" class="text-rose-700 hover:text-rose-900 font-medium">Diagnostic Tool</a>
                    <a href="#research" class="text-rose-700 hover:text-rose-900 font-medium">Validation</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="relative py-20 px-4 sm:px-6 lg:px-8 text-center">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-6xl font-bold text-rose-800 mb-6 font-serif">
                Empowering Early Detection
            </h1>
            <p class="text-xl text-rose-600 mb-8 max-w-2xl mx-auto">
                Advanced Dual-Stream AI technology to support breast health awareness and detect abnormalities in dense tissue.
            </p>
            <a href="#tool" class="bg-rose-500 hover:bg-rose-600 text-white px-8 py-3 rounded-full font-medium text-lg shadow-lg hover:shadow-xl transition">
                Start Detection
            </a>
        </div>
    </section>

    <!-- DIAGNOSTIC TOOL SECTION (The Working Part) -->
    <section id="tool" class="py-16 px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-xl border border-rose-100 overflow-hidden">
            <div class="bg-rose-500 p-6 text-center">
                <h2 class="text-2xl font-bold text-white font-serif">AI Analysis Interface</h2>
                <p class="text-rose-100">Upload a mammogram for instant density-aware screening</p>
            </div>
            
            <div class="p-8">
                <form id="uploadForm" class="space-y-6">
                    
                    <!-- File Drop Zone -->
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Mammogram Image</label>
                        <div class="relative border-2 border-dashed border-rose-300 rounded-lg p-8 text-center hover:bg-rose-50 transition cursor-pointer">
                            <input type="file" name="file" id="file-upload" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" accept=".png, .jpg, .jpeg" required>
                            <div class="space-y-2">
                                <i class="fa-solid fa-cloud-arrow-up text-4xl text-rose-400"></i>
                                <p class="text-sm text-gray-600">Click to upload or drag and drop</p>
                                <p class="text-xs text-rose-500 font-semibold" id="filename">No file selected</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Breast Density</label>
                            <select name="density" class="w-full border-gray-300 rounded-md shadow-sm border p-2 focus:border-rose-500 focus:ring-rose-500">
                                <option value="A">Type A: Fatty</option>
                                <option value="B">Type B: Scattered</option>
                                <option value="C">Type C: Heterogeneous</option>
                                <option value="D">Type D: Extremely Dense</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">View Position</label>
                            <select name="view" class="w-full border-gray-300 rounded-md shadow-sm border p-2 focus:border-rose-500 focus:ring-rose-500">
                                <option value="CC">CC (Top-Down)</option>
                                <option value="MLO">MLO (Side View)</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-rose-600 hover:bg-rose-700 text-white py-3 px-4 rounded-lg font-bold shadow-md transition transform hover:-translate-y-0.5">
                        Run Analysis
                    </button>
                </form>

                <!-- Loading & Results -->
                <div id="loading" class="hidden mt-8 text-center">
                    <div class="inline-block animate-spin rounded-full h-10 w-10 border-4 border-rose-200 border-t-rose-600"></div>
                    <p class="mt-2 text-rose-600">Processing Scan...</p>
                </div>

                <div id="result-box" class="hidden mt-8 p-6 rounded-lg border text-center">
                    <h3 id="prediction-text" class="text-2xl font-serif font-bold mb-2"></h3>
                    <p id="confidence-text" class="text-lg"></p>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-4">
                        <div id="conf-bar" class="h-2.5 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- RESEARCH DASHBOARD (Visual Proof) -->
    <section id="research" class="py-16 px-4 sm:px-6 lg:px-8 bg-white/60">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-3xl font-bold text-center text-rose-800 mb-12 font-serif">Engineering Validation</h2>
            <div class="grid md:grid-cols-3 gap-8">
                
                <!-- Card 1 -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-rose-100">
                    <div class="h-48 bg-gray-50 flex items-center justify-center">
                        <img src="{{ url_for('static', filename='images/density_analysis.png') }}" alt="Density Chart" class="max-h-full p-2">
                    </div>
                    <div class="p-6">
                        <h3 class="font-bold text-rose-800 mb-2">The Density Challenge</h3>
                        <p class="text-sm text-gray-600">Validating that higher density (C/D) leads to higher occlusion rates.</p>
                    </div>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-rose-100">
                    <div class="h-48 bg-gray-50 flex items-center justify-center">
                        <img src="{{ url_for('static', filename='images/distribution_diagnosis.png') }}" alt="Dataset" class="max-h-full p-2">
                    </div>
                    <div class="p-6">
                        <h3 class="font-bold text-rose-800 mb-2">Dataset Balance</h3>
                        <p class="text-sm text-gray-600">Addressing the 98:2 class imbalance with Weighted Loss functions.</p>
                    </div>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-rose-100">
                    <div class="h-48 bg-gray-50 flex items-center justify-center">
                        <img src="{{ url_for('static', filename='images/sample_predictions.png') }}" alt="AI Vision" class="max-h-full p-2">
                    </div>
                    <div class="p-6">
                        <h3 class="font-bold text-rose-800 mb-2">Dual-Stream Vision</h3>
                        <p class="text-sm text-gray-600">Real-time inference samples showing high-recall detection.</p>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <footer class="bg-rose-50 border-t border-rose-100 py-12 text-center mt-12">
        <p class="text-rose-800 font-serif font-bold text-lg">BreastCare AI Project 2025</p>
        <p class="text-xs text-gray-500 mt-2">Research Prototype Only - Not for Clinical Use</p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // File Upload UI
        document.getElementById('file-upload').addEventListener('change', function() {
            const fileName = this.files[0] ? this.files[0].name : "No file selected";
            document.getElementById('filename').textContent = "Selected: " + fileName;
        });

        // Form Submit
        document.getElementById('uploadForm').onsubmit = async function(e) {
            e.preventDefault();
            
            // Show Loading
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('result-box').classList.add('hidden');
            document.getElementById('uploadForm').style.opacity = "0.5";

            let formData = new FormData(this);

            try {
                // Fake delay for UX
                await new Promise(r => setTimeout(r, 1500));

                let response = await fetch('/predict', { method: 'POST', body: formData });
                let data = await response.json();
                
                // Hide Loading
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('uploadForm').style.opacity = "1";
                
                // Show Result
                let resBox = document.getElementById('result-box');
                resBox.classList.remove('hidden');
                
                let predText = document.getElementById('prediction-text');
                let confText = document.getElementById('confidence-text');
                let confBar = document.getElementById('conf-bar');

                if (data.error) {
                    resBox.className = "mt-8 p-6 rounded-lg border text-center bg-red-50 border-red-200 text-red-800";
                    predText.textContent = "Error";
                    confText.textContent = data.error;
                } else {
                    predText.textContent = data.prediction;
                    confText.textContent = "Confidence Score: " + data.confidence;
                    
                    // Style based on result
                    if(data.risk_score > 0.5) {
                        resBox.className = "mt-8 p-6 rounded-lg border text-center bg-red-50 border-red-200 text-red-800";
                        confBar.className = "h-full rounded-full bg-red-600 transition-all duration-1000";
                    } else {
                        resBox.className = "mt-8 p-6 rounded-lg border text-center bg-green-50 border-green-200 text-green-800";
                        confBar.className = "h-full rounded-full bg-green-600 transition-all duration-1000";
                    }
                    
                    // Animate Bar
                    setTimeout(() => {
                        confBar.style.width = (data.risk_score * 100) + "%";
                    }, 100);
                }

            } catch (error) {
                alert("Server Error: Ensure app.py is running!");
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('uploadForm').style.opacity = "1";
            }
        }
    </script>
</body>
</html>